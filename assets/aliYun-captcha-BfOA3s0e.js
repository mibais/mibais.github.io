import{_ as y,k as g}from"./index-CDfL52KE.js";import{V as _}from"./antd-D-bStUmV.js";import{d as b,f as l,s as u,D as v,o as k,a5 as B,a3 as w,k as R,ad as x,G as C,af as z,u as E,a8 as I}from"./vue-BVKynzoK.js";const V=I("div",{id:"captcha-element"},null,-1),A=b({__name:"aliYun-captcha",props:{loginParam:{type:Object,required:!0},loginText:{type:String,required:!0}},emits:["submit"],setup(n,{emit:i}){const s=i,r=n,a=l(!1),o=u(),p=u(),c=l();function d(t){p.value=t}async function m(t){a.value=!0;try{const{data:e}=await g({...r.loginParam,type:"captcha",extra:t});return c.value=e.token,a.value=!1,e.code?{captchaResult:e.code!=="2",bizResult:e.code==="0"}:{captchaResult:!0,bizResult:!0}}catch{return a.value=!1,{captchaResult:!1,bizResult:!1}}}function h(){s("submit",c.value)}return v(()=>{var t,e;o.value=null,(t=document.getElementById("aliyunCaptcha-mask"))==null||t.remove(),(e=document.getElementById("aliyunCaptcha-window-popup"))==null||e.remove()}),k(async()=>{await y(()=>import("https://o.alicdn.com/captcha-frontend/aliyunCaptcha/AliyunCaptcha.js"),__vite__mapDeps([])),o.value=document.getElementById("captcha-button"),window.initAliyunCaptcha({SceneId:"1fukhz9t7",prefix:"2oy85yh",mode:"popup",element:"#captcha-element",button:"#captcha-button",captchaVerifyCallback:m,onBizResultCallback:h,getInstance:d,slideStyle:{width:360,height:40},language:"cn"})}),(t,e)=>{const f=_;return B(),w("div",null,[R(f,{id:"captcha-button",type:"primary",block:"",loading:E(a),size:"large"},{default:x(()=>[C(z(n.loginText),1)]),_:1},8,["loading"]),V])}}});export{A as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
