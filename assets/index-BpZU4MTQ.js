import{_ as E}from"./index.vue_vue_type_script_setup_true_lang-DOdBLNaE.js";import{_ as K}from"./edit.vue_vue_type_script_setup_true_lang-RLl1t_rT.js";import{_ as q}from"./cover.vue_vue_type_script_setup_true_lang-CX9-xiJJ.js";import{a as L,d as W}from"./shop-D2fJGAEf.js";import{u as X}from"./index-Ct-BVKny.js";import{aU as Y,aV as Z,aP as ee,K as te,N as ae,aa as ne,aI as oe,aJ as se,ab as le,S as ue,m as ie,F as _e,a9 as de,a0 as pe,aw as re,an as ce,s as me,am as fe}from"./antd-Ckg-4fVb.js";import{d as ge,f as c,s as ve,r as ye,o as xe,a5 as i,ac as m,ad as e,k as t,u as a,G as l,a3 as z,F as B,af as ke,ag as d,ak as O,H as Ce,a8 as we}from"./vue-CP9fVXMC.js";import"./context-BpgvqFZZ.js";import"./coverEdit.vue_vue_type_script_setup_true_lang-BmBcy3Ov.js";const he=we("span",{"text-20px":"","line-height-32px":"","mr-12px":"","mb-0":"",truncate:"","font-600":""},"商品管理",-1),Me=ge({__name:"index",setup(be){const f=c(!1),p=c(!1),N=ve([{title:"#",dataIndex:"id"},{title:"商品名称",dataIndex:"name"},{title:"价格",dataIndex:"price",width:120,ellipsis:!0},{title:"流量",dataIndex:"bandwidth"},{title:"分组",dataIndex:"nodeGroup"},{title:"状态",dataIndex:"status"},{title:"操作",dataIndex:"action",width:200}]),x=c(0),h=c(),u=ye({pageSize:10,current:1,total:0,pageSizeOptions:["10","20","30","40"],showSizeChanger:!0,showQuickJumper:!0,showTotal:o=>`${o}条记录`,onChange(o,n){u.pageSize=n,u.current=o,g()}}),r=c({name:void 0,status:void 0});async function g(){if(!f.value){f.value=!0;try{const{data:o}=await L({size:u.pageSize,current:u.current,param:r.value});h.value=o.records,u.total=o.total,u.pageSize=o.size,u.current=o.current}finally{f.value=!1}}}function V(){g()}function F(o){x.value=o.id,p.value=!0}async function M(o){await W(o),X().success("商品删除成功"),await g()}function U(){x.value=void 0,p.value=!0}function D(o){p.value=!1,o&&g()}const _=c(!1);return xe(()=>{g()}),(o,n)=>{const G=te,b=ae,k=ne,S=oe,A=se,C=le,v=ue,w=ie,H=_e,I=de,$=pe,J=re,P=ce,Q=me,R=fe,T=E;return i(),m(T,null,{title:e(()=>[he]),default:e(()=>[t(I,{"mb-4":""},{default:e(()=>[t(H,{modal:a(r)},{default:e(()=>[t(C,{gutter:16},{default:e(()=>[t(k,{span:12},{default:e(()=>[t(b,{label:"商品名",name:"name"},{default:e(()=>[t(G,{value:a(r).name,"onUpdate:value":n[0]||(n[0]=s=>a(r).name=s)},null,8,["value"])]),_:1})]),_:1}),t(k,{span:12},{default:e(()=>[t(b,{label:"状态",name:"status"},{default:e(()=>[t(A,{value:a(r).status,"onUpdate:value":n[1]||(n[1]=s=>a(r).status=s)},{default:e(()=>[t(S,{value:1},{default:e(()=>[l(" 上架 ")]),_:1}),t(S,{value:0},{default:e(()=>[l(" 下架 ")]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(C,{span:24,style:{"text-align":"right"}},{default:e(()=>[t(k,{span:24},{default:e(()=>[t(w,{flex:"","justify-end":"","w-full":""},{default:e(()=>[t(v,{loading:a(f),type:"primary",onClick:V},{default:e(()=>[l(" 查询 ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modal"])]),_:1}),t(C,{gutter:24},{default:e(()=>[t(k,{span:24},{default:e(()=>[t(I,{title:"商品列表"},{extra:e(()=>[t(w,null,{default:e(()=>[t(v,{type:"default",size:"middle",onClick:U},{icon:e(()=>[t(a(Y))]),default:e(()=>[l(" 添加商品 ")]),_:1}),t(v,{type:"default",size:"middle",onClick:n[2]||(n[2]=s=>_.value=!0)},{icon:e(()=>[t(a(Z))]),default:e(()=>[l(" 管理封页 ")]),_:1})]),_:1})]),default:e(()=>[t(P,{loading:a(f),columns:a(N),"data-source":a(h),pagination:a(u),scroll:{x:100}},{bodyCell:e(({column:s,record:y})=>[s.dataIndex==="bandwidth"?(i(),z(B,{key:0},[l(ke(y.content.bandwidth)+" GB ",1)],64)):d("",!0),s.dataIndex==="status"?(i(),z(B,{key:1},[y.status===1?(i(),m($,{key:0,color:"#108ee9"},{default:e(()=>[l(" 上架中 ")]),_:1})):d("",!0),y.status===0?(i(),m($,{key:1,color:"#f50"},{default:e(()=>[l(" 已下架 ")]),_:1})):d("",!0)],64)):d("",!0),s.dataIndex==="action"?(i(),m(w,{key:2},{default:e(()=>[t(v,{type:"primary",onClick:j=>F(y)},{default:e(()=>[l(" 修改 ")]),_:2},1032,["onClick"]),t(J,{title:"确定要删除节点吗？",onConfirm:j=>M(y.id)},{icon:e(()=>[t(a(ee))]),default:e(()=>[t(v,{danger:"",type:"primary"},{default:e(()=>[l(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)):d("",!0)]),_:1},8,["loading","columns","data-source","pagination"])]),_:1})]),_:1})]),_:1}),t(Q,{title:a(x)?"编辑商品":"添加商品",width:720,visible:a(p),"body-style":{paddingBottom:"80px"},onClose:n[3]||(n[3]=s=>p.value=!1)},{default:e(()=>[a(p)?(i(),m(O(K),{key:0,"shop-id":a(x),onHandleClose:D},null,40,["shop-id"])):d("",!0)]),_:1},8,["title","visible"]),t(R,{open:a(_),"onUpdate:open":n[4]||(n[4]=s=>Ce(_)?_.value=s:null),width:800,title:"管理封页","mask-closable":!1,onCancel:n[5]||(n[5]=s=>_.value=!1),onOk:n[6]||(n[6]=s=>_.value=!1)},{default:e(()=>[a(_)?(i(),m(O(q),{key:0})):d("",!0)]),_:1},8,["open"])]),_:1})}}});export{Me as default};
