import{u as M,_ as U}from"./index-LY3ioL-D.js";import{K as j,N as R,S as V,F as D,aH as O,a9 as G}from"./antd-DotIiKV0.js";import{d as H,f as v,w as k,a5 as g,ac as h,ad as a,U as w,k as f,u,a3 as q,F as z,al as A,G as C,af as I,ag as J,n as S}from"./vue-DIvP5FMT.js";const P=H({__name:"index",props:{length:{type:Number,default:6},warningMessage:{type:String,default:"请补全验证码"},countdown:{type:Number,default:60},resend:{type:Boolean,default:!1},verifyLoading:{type:Boolean,default:!0},immediate:{type:Number,default:0},sendText:{type:String,default:"提交"}},emits:["handleSubmit","handleResend"],setup(p,{emit:N}){const n=p,y=N,o=v({}),l=v(!1),B=M();let _=null;const i=v(0);k(()=>n.length,()=>{for(let e=0;e<n.length;e++)o.value[`code${e}`]=""},{immediate:!0});async function $(){const e=Object.values(o.value).join("");if(e.length!==n.length){B.warning(n.warningMessage);return}y("handleSubmit",e)}function x(e,t){var r;const s=(r=t.target)==null?void 0:r.value;if(o.value[`code${e}`]=s,s&&e<n.length-1){const c=t.target.nextElementSibling;c&&S(()=>{c.focus()})}}function T(e,t){if(t.key==="Backspace"&&!t.target.value&&e>0){const s=t.target.previousElementSibling;s&&S(()=>{s.focus()})}}function b(e){const t=e;i.value=t,_||(_=setInterval(()=>{i.value>0&&i.value<=t?i.value--:(l.value=!1,clearInterval(_),_=null)},1e3))}function F(){if(!l.value){l.value=!0;try{y("handleResend"),b(n.countdown)}catch{l.value=!1}}}return k(()=>n.immediate,e=>{n.resend&&e>0&&(l.value=!0,b(n.immediate))},{immediate:!0}),(e,t)=>{const s=j,r=R,c=V,E=D,K=O,L=G;return g(),h(L,{hoverable:""},{title:a(()=>[w(e.$slots,"title",{},void 0,!0)]),default:a(()=>[f(K,{vertical:"",justify:"center",align:"center",gap:"small"},{default:a(()=>[w(e.$slots,"head",{},void 0,!0),f(E,{"mt-5":"","label-align":"right",model:u(o),onFinish:$},{default:a(()=>[f(r,null,{default:a(()=>[(g(!0),q(z,null,A(u(o),(Q,W,d)=>(g(),h(s,{key:d,value:u(o)[`code${d}`],"onUpdate:value":m=>u(o)[`code${d}`]=m,controls:!1,maxlength:1,class:"verification-input",onInput:m=>x(d,m),onKeydown:m=>T(d,m)},null,8,["value","onUpdate:value","onInput","onKeydown"]))),128))]),_:1}),f(r,null,{default:a(()=>[f(c,{loading:p.verifyLoading,"mb-3":"",block:"","html-type":"submit",type:"primary"},{default:a(()=>[C(I(p.sendText),1)]),_:1},8,["loading"]),p.resend?(g(),h(c,{key:0,block:"",disabled:u(l),type:"dashed",onClick:F},{default:a(()=>[C(I(u(l)?`${u(i)}秒后重发`:"发送"),1)]),_:1},8,["disabled"])):J("",!0)]),_:1})]),_:1},8,["model"])]),_:3})]),_:3})}}}),ee=U(P,[["__scopeId","data-v-e2da1db4"]]);export{ee as v};
