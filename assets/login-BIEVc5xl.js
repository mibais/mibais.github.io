var ie=Object.defineProperty;var re=(s,o,a)=>o in s?ie(s,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[o]=a;var f=(s,o,a)=>(re(s,typeof o!="symbol"?o+"":o,a),a);import{_ as ce}from"./index.vue_vue_type_script_setup_true_lang-xLrRx2fA.js";import{_ as le,a as pe,b as ue}from"./login-left-t-zZ_UNH.js";import{_ as de}from"./logo-B20em0cI.js";import{f as $,d as me,g as A,e as _e,h as E,A as he,_ as ge,j as fe}from"./index-d7i-9Cua.js";import{g as w}from"./tools-DMMyolKQ.js";import{t as I}from"./third-part-fnhvkpeN.js";import{d as k,W as ve,r as we,s as M,f as H,ap as be,o as S,u as e,j as ye,a3 as q,a8 as i,af as v,ac as P,k as r,ad as m,aq as z,a5 as h,ag as xe,G as B,a6 as ke,a7 as Ce,ak as Le}from"./vue-DIvP5FMT.js";import{B as Ie,F as Me,U as Pe,E as $e,G as Ae,H as Ee,I as Se,y as qe,T as ze,J as Ue,K as Ge,N as Te,O as Be,Q as Oe,S as Re}from"./antd-CrhK6lnF.js";var We=async(s=0)=>new Promise(o=>{const a=setTimeout(()=>{o(!0),clearTimeout(a)},s)});const t={width:0,height:0,canvas:null,ctx:null,circles:[],animate:!0,requestId:null},Ne=function(s){if(!t||!s)throw new Error("no canvasInstance");t.width=window.innerWidth,t.height=window.innerHeight,t.canvas=s,t.canvas.width=t.width,t.canvas.height=t.height,t.ctx=t.canvas.getContext("2d"),t.circles=[];for(let o=0;o<t.width*.5;o++){const a=new je;t.circles.push(a)}D(),Fe()};function K(){t.animate=!(document.body.scrollTop>t.height)}function V(){t.width=window.innerWidth,t.height=window.innerHeight,t.canvas.width=t.width,t.canvas.height=t.height}function D(){if(t.animate){t.ctx.clearRect(0,0,t.width,t.height);for(const s in t.circles)t.circles[s].draw()}t.requestId=requestAnimationFrame(D)}class je{constructor(){f(this,"pos");f(this,"alpha");f(this,"scale");f(this,"velocity");f(this,"draw");this.pos={x:Math.random()*t.width,y:t.height+Math.random()*100},this.alpha=.1+Math.random()*.3,this.scale=.1+Math.random()*.3,this.velocity=Math.random();const o=Math.random()*255,a=Math.random()*255,u=Math.random()*255;this.draw=function(){this.pos.y-=this.velocity,this.alpha-=5e-4,t.ctx.beginPath(),t.ctx.arc(this.pos.x,this.pos.y,this.scale*10,0,2*Math.PI,!1),t.ctx.fillStyle=`rgba(${o},${a},${u},${this.alpha})`,t.ctx.fill()}}}function Fe(){window.addEventListener("scroll",K),window.addEventListener("resize",V)}function He(){window.removeEventListener("scroll",K),window.removeEventListener("resize",V),cancelAnimationFrame(t.requestId)}const j={init:Ne,removeListeners:He},O=s=>(ke("data-v-c4a3cf5e"),s=s(),Ce(),s),Ke={class:"login-container"},Ve={"h-screen":"","w-screen":"",absolute:"","z-10":""},De={class:"login-content flex-center"},Qe={class:"ant-pro-form-login-main rounded"},Je={class:"flex-between h-15 px-4 mb-[2px]"},Xe={class:"flex-end"},Ye=O(()=>i("span",{class:"ant-pro-form-login-logo"},[i("img",{"w-full":"","h-full":"","object-cover":"",src:de})],-1)),Ze=O(()=>i("span",{class:"ant-pro-form-login-title"}," 米白云 ",-1)),et={class:"ant-pro-form-login-desc"},tt={class:"login-lang flex-center relative z-11"},ot={class:"box-border flex min-h-[520px]"},nt=O(()=>i("div",{class:"ant-pro-form-login-main-left min-h-[520px] flex-center bg-[var(--bg-color-container)]"},[i("img",{src:le,class:"h-5/6 w-5/6"})],-1)),st={class:"ant-pro-form-login-main-right px-5 w-[335px] flex-center flex-col relative z-11"},at={class:"text-center py-6 text-2xl"},it={class:"mb-24px flex-between"},rt={href:"/forget"},ct={class:"text-slate-500"},lt={class:"ant-pro-form-login-other"},pt=60,ut=k({__name:"login-sys",setup(s){const o=$(),a=me(),{layoutSetting:u}=ve(a),d=z(),l=A(),n=we({email:void 0,password:void 0,mobile:void 0,code:void 0,type:"account",remember:!0}),{t:c}=_e(),b=M(),y=M(!1),C=M(!1),L=H(),{pause:Q}=be(1e3,{controls:!0,immediate:!1,callback(g){g&&g===pt&&Q()}});function J(){window.location.href=I.getGithubLoginUrl()}function X(){window.location.href=I.getAliLoginUrl()}function Y(){window.location.href=I.getGoogleLoginUrl()}async function U(){var g;y.value=!0;try{await((g=b.value)==null?void 0:g.validate());const p={email:n.email,password:n.password,type:"sys"},{data:x}=await E(p);l.value=x==null?void 0:x.token,o.success({message:"登录成功",description:"欢迎回来！",duration:3});const G=w("redirect","/");await d.push({path:G,replace:!0})}catch(p){p instanceof he&&(C.value=!0),y.value=!1}}return S(async()=>{await We(300),j.init(e(L))}),ye(()=>{j.removeListeners()}),(g,p)=>{const x=pe,G=ue,Z=ce,T=Ie,R=qe,ee=ze,te=Ue,oe=Ge,W=Te,ne=Be,se=Oe,N=Re,ae=Me;return h(),q("div",Ke,[i("div",Ve,[i("canvas",{ref_key:"bubbleCanvas",ref:L},null,512)]),i("div",De,[i("div",Qe,[i("div",Je,[i("div",Xe,[Ye,Ze,i("span",et,v(e(c)("pages.layouts.userLayout.title")),1)]),i("div",tt,[i("span",{class:"flex-center cursor-pointer text-16px",onClick:p[0]||(p[0]=_=>e(a).toggleTheme(e(u).theme==="dark"?"light":"dark"))},[e(u).theme==="light"?(h(),P(x,{key:0})):(h(),P(G,{key:1}))]),r(Z)])]),r(T,{"m-0":""}),i("div",ot,[nt,r(T,{"m-0":"",type:"vertical",class:"ant-pro-login-divider min-h-[520px]"}),i("div",st,[i("div",at,v(e(c)("pages.login.tips")),1),r(ae,{ref_key:"formRef",ref:b,model:e(n)},{default:m(()=>[r(ee,{activeKey:e(n).type,"onUpdate:activeKey":p[1]||(p[1]=_=>e(n).type=_),centered:""},{default:m(()=>[r(R,{key:"account",tab:e(c)("pages.login.accountLogin.tab")},null,8,["tab"]),r(R,{key:"mobile",disabled:"",tab:e(c)("pages.login.phoneLogin.tab")},null,8,["tab"])]),_:1},8,["activeKey"]),e(C)?(h(),P(te,{key:0,"mb-24px":"",message:e(c)("pages.login.accountLogin.errorMessage"),type:"error","show-icon":""},null,8,["message"])):xe("",!0),r(W,{name:"email",rules:[{required:!0,message:e(c)("pages.login.email.required")}]},{default:m(()=>[r(oe,{value:e(n).email,"onUpdate:value":p[2]||(p[2]=_=>e(n).email=_),"allow-clear":"",autocomplete:"off",placeholder:e(c)("pages.login.email.placeholder"),size:"large",onPressEnter:U},{prefix:m(()=>[r(e(Pe))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"]),r(W,{name:"password",rules:[{required:!0,message:e(c)("pages.login.password.required")}]},{default:m(()=>[r(ne,{value:e(n).password,"onUpdate:value":p[3]||(p[3]=_=>e(n).password=_),"allow-clear":"",placeholder:e(c)("pages.login.password.placeholder"),size:"large",onPressEnter:U},{prefix:m(()=>[r(e($e))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"]),i("div",it,[r(se,{checked:e(n).remember,"onUpdate:checked":p[4]||(p[4]=_=>e(n).remember=_)},{default:m(()=>[B(v(e(c)("pages.login.rememberMe")),1)]),_:1},8,["checked"]),i("a",rt,v(e(c)("pages.login.forgotPassword")),1)]),r(N,{type:"primary",block:"",loading:e(y),size:"large",onClick:U},{default:m(()=>[B(v(e(c)("pages.login.submit")),1)]),_:1},8,["loading"]),r(N,{"mt-5":"",block:"",href:"/register"},{default:m(()=>[B(" 没有账号？去注册 ")]),_:1})]),_:1},8,["model"]),r(T,null,{default:m(()=>[i("span",ct,v(e(c)("pages.login.loginWith")),1)]),_:1}),i("div",lt,[r(e(Ae),{class:"icon",onClick:J}),r(e(Ee),{disabled:"",class:"icon",onClick:X}),r(e(Se),{disabled:"",class:"icon",onClick:Y})])])])])])])}}}),F=ge(ut,[["__scopeId","data-v-c4a3cf5e"]]),dt=k({__name:"login-github",setup(s){const o=A(),a=z(),u=$();async function d(){const{data:l}=await E({type:"github",clientId:I.getGithubClientId(),code:w("code")});o.value=l==null?void 0:l.token,u.success({message:"登录成功",description:"欢迎回来！",duration:3});const n=w("redirect","/");a.push({path:n,replace:!0})}return S(()=>{d()}),(l,n)=>(h(),q("div"))}}),mt=k({__name:"login-alipay",setup(s){const o=A(),a=z(),u=$();async function d(){const{data:l}=await E({type:"alipay",code:w("auth_code")});o.value=l==null?void 0:l.token,u.success({message:"登录成功",description:"欢迎回来！",duration:3});const n=w("redirect","/");a.push({path:n,replace:!0})}return S(()=>{d()}),(l,n)=>(h(),q("div"))}}),_t=k({__name:"login-google",props:{hashParams:{type:Object,required:!0}},setup(s){const o=s,a=A(),u=z(),d=$();async function l(){const{data:n}=await E({type:"google",code:o.hashParams.access_token});a.value=n==null?void 0:n.token,d.success({message:"登录成功",description:"欢迎回来！",duration:3}),u.push({path:"/",replace:!0})}return S(()=>{l()}),(n,c)=>(h(),q("div"))}}),Ct=k({__name:"login",setup(s){const o=M(),a={sys:F,github:dt,alipay:mt,google:_t},u=H(l());let d=w("type");d||(d=u.value.state??""),o.value=a[d]??F;function l(){const c=fe.currentRoute.value.hash.substring(1).split("&"),b={};return c.forEach(y=>{const[C,L]=y.split("=");b[C]=L}),b}return(n,c)=>(h(),P(Le(e(o)),{"hash-params":e(u)},null,8,["hash-params"]))}});export{Ct as default};
