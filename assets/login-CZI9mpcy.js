var re=Object.defineProperty;var ce=(n,o,a)=>o in n?re(n,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[o]=a;var v=(n,o,a)=>(ce(n,typeof o!="symbol"?o+"":o,a),a);import{_ as le}from"./index.vue_vue_type_script_setup_true_lang-BKxEhDLV.js";import{_ as pe,a as ue,b as de}from"./login-left-CWtDRvqM.js";import{e as W,f as _e,_ as $,g as P,d as me,h as I,j as he,k as O,m as ge}from"./index-CDfL52KE.js";import{t as L}from"./third-part-fnhvkpeN.js";import{d as w,a5 as m,ac as x,u as e,ap as fe,W as ve,r as be,s as q,f as N,aq as we,o as T,j as ye,a3 as A,a8 as r,af as y,k as c,ad as _,ar as E,ag as xe,G,a6 as ke,a7 as Ce,ak as Le}from"./vue-BVKynzoK.js";import{g as b}from"./tools-BD_3V2zt.js";import{B as Pe,F as Ie,E as Te,G as Ae,H as Ee,I as Me,J as Se,y as $e,T as qe,K as Oe,N as Re,O as ze,Q as Be,S as Ge,V as Ue}from"./antd-D-bStUmV.js";var Ve=async(n=0)=>new Promise(o=>{const a=setTimeout(()=>{o(!0),clearTimeout(a)},n)});const We="https://asset.mebi.me:8012/logo.png",t={width:0,height:0,canvas:null,ctx:null,circles:[],animate:!0,requestId:null},Ne=function(n){if(!t||!n)throw new Error("no canvasInstance");t.width=window.innerWidth,t.height=window.innerHeight,t.canvas=n,t.canvas.width=t.width,t.canvas.height=t.height,t.ctx=t.canvas.getContext("2d"),t.circles=[];for(let o=0;o<t.width*.5;o++){const a=new je;t.circles.push(a)}F(),De()};function j(){t.animate=!(document.body.scrollTop>t.height)}function D(){t.width=window.innerWidth,t.height=window.innerHeight,t.canvas.width=t.width,t.canvas.height=t.height}function F(){if(t.animate){t.ctx.clearRect(0,0,t.width,t.height);for(const n in t.circles)t.circles[n].draw()}t.requestId=requestAnimationFrame(F)}class je{constructor(){v(this,"pos");v(this,"alpha");v(this,"scale");v(this,"velocity");v(this,"draw");this.pos={x:Math.random()*t.width,y:t.height+Math.random()*100},this.alpha=.1+Math.random()*.3,this.scale=.1+Math.random()*.3,this.velocity=Math.random();const o=Math.random()*255,a=Math.random()*255,p=Math.random()*255;this.draw=function(){this.pos.y-=this.velocity,this.alpha-=5e-4,t.ctx.beginPath(),t.ctx.arc(this.pos.x,this.pos.y,this.scale*10,0,2*Math.PI,!1),t.ctx.fillStyle=`rgba(${o},${a},${p},${this.alpha})`,t.ctx.fill()}}}function De(){window.addEventListener("scroll",j),window.addEventListener("resize",D)}function Fe(){window.removeEventListener("scroll",j),window.removeEventListener("resize",D),cancelAnimationFrame(t.requestId)}const U={init:Ne,removeListeners:Fe},He=w({__name:"index",props:{loginParam:{type:Object,required:!0}},emits:["submit"],setup(n,{emit:o}){const a={aliYun:()=>$(()=>import("./aliYun-captcha-BfOA3s0e.js"),__vite__mapDeps([0,1,2,3,4])),geetest:()=>$(()=>import("./geetest-DhOR7D1P.js"),__vite__mapDeps([5,1,2,3,4])),sys:()=>$(()=>import("./original-CTwG1M04.js"),__vite__mapDeps([6,1,2,3,4]))},p=o,{t:u}=W(),l=fe(()=>new Promise(async i=>{const{data:g}=await _e();i(a[g]())}));function s(i){p("submit",i)}return(i,g)=>(m(),x(e(l),{loginParam:{...n.loginParam},loginText:e(u)("pages.login.submit"),onSubmit:s},null,8,["loginParam","loginText"]))}}),R=n=>(ke("data-v-59a07a19"),n=n(),Ce(),n),Ke={class:"login-container"},Qe={"h-screen":"","w-screen":"",absolute:"","z-10":""},Je={class:"login-content flex-center"},Ye={class:"ant-pro-form-login-main rounded"},Xe={class:"flex-between h-15 px-4 mb-[2px]"},Ze={class:"flex-end"},et=R(()=>r("span",{class:"ant-pro-form-login-logo"},[r("img",{"w-full":"","h-full":"","object-cover":"",src:We})],-1)),tt=R(()=>r("span",{class:"ant-pro-form-login-title"}," 米白云 ",-1)),ot={class:"ant-pro-form-login-desc"},nt={class:"login-lang flex-center relative z-11"},st={class:"box-border flex min-h-[520px]"},at=R(()=>r("div",{class:"ant-pro-form-login-main-left min-h-[520px] flex-center bg-[var(--bg-color-container)]"},[r("img",{src:pe,class:"h-5/6 w-5/6"})],-1)),it={class:"ant-pro-form-login-main-right px-5 w-[335px] flex-center flex-col relative z-11"},rt={class:"text-center py-6 text-2xl"},ct={class:"mb-24px flex-between"},lt={href:"/forget"},pt={class:"text-slate-500"},ut={class:"ant-pro-form-login-other"},dt=60,_t=w({__name:"login-sys",setup(n){const o=P(),a=me(),{layoutSetting:p}=ve(a),u=E(),l=I(),s=be({email:void 0,password:void 0,mobile:void 0,code:void 0,type:"sys",remember:!0}),{t:i}=W(),g=q(),k=q(!1),C=N(),{pause:M}=we(1e3,{controls:!0,immediate:!1,callback(f){f&&f===dt&&M()}});async function H(f){if(!f)return k.value=!0;l.value=f,o.success({message:"登录成功",description:"欢迎回来！",duration:3});const d=b("redirect","/");await u.push({path:d,replace:!0})}function K(){window.location.href=L.getGithubLoginUrl()}function Q(){window.location.href=L.getAliLoginUrl()}function J(){window.location.href=L.getGoogleLoginUrl()}return T(async()=>{await Ve(300),U.init(e(C))}),ye(()=>{U.removeListeners()}),(f,d)=>{const Y=ue,X=de,Z=le,S=Pe,z=$e,ee=qe,te=Oe,oe=Re,B=ze,ne=Be,se=Ge,ae=Ue,ie=Ie;return m(),A("div",Ke,[r("div",Qe,[r("canvas",{ref_key:"bubbleCanvas",ref:C},null,512)]),r("div",Je,[r("div",Ye,[r("div",Xe,[r("div",Ze,[et,tt,r("span",ot,y(e(i)("pages.layouts.userLayout.title")),1)]),r("div",nt,[r("span",{class:"flex-center cursor-pointer text-16px",onClick:d[0]||(d[0]=h=>e(a).toggleTheme(e(p).theme==="dark"?"light":"dark"))},[e(p).theme==="light"?(m(),x(Y,{key:0})):(m(),x(X,{key:1}))]),c(Z)])]),c(S,{"m-0":""}),r("div",st,[at,c(S,{"m-0":"",type:"vertical",class:"ant-pro-login-divider min-h-[520px]"}),r("div",it,[r("div",rt,y(e(i)("pages.login.tips")),1),c(ie,{ref_key:"formRef",ref:g,model:e(s)},{default:_(()=>[c(ee,{activeKey:e(s).type,"onUpdate:activeKey":d[1]||(d[1]=h=>e(s).type=h),centered:""},{default:_(()=>[c(z,{key:"account",tab:e(i)("pages.login.accountLogin.tab")},null,8,["tab"]),c(z,{key:"mobile",disabled:"",tab:e(i)("pages.login.phoneLogin.tab")},null,8,["tab"])]),_:1},8,["activeKey"]),e(k)?(m(),x(te,{key:0,"mb-24px":"",message:e(i)("pages.login.accountLogin.errorMessage"),type:"error","show-icon":""},null,8,["message"])):xe("",!0),c(B,{name:"email",rules:[{required:!0,message:e(i)("pages.login.email.required")}]},{default:_(()=>[c(oe,{value:e(s).email,"onUpdate:value":d[2]||(d[2]=h=>e(s).email=h),"allow-clear":"",autocomplete:"off",placeholder:e(i)("pages.login.email.placeholder"),size:"large"},{prefix:_(()=>[c(e(Te))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"]),c(B,{name:"password",rules:[{required:!0,message:e(i)("pages.login.password.required")}]},{default:_(()=>[c(ne,{value:e(s).password,"onUpdate:value":d[3]||(d[3]=h=>e(s).password=h),"allow-clear":"",placeholder:e(i)("pages.login.password.placeholder"),size:"large"},{prefix:_(()=>[c(e(Ae))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"]),r("div",ct,[c(se,{checked:e(s).remember,"onUpdate:checked":d[4]||(d[4]=h=>e(s).remember=h)},{default:_(()=>[G(y(e(i)("pages.login.rememberMe")),1)]),_:1},8,["checked"]),r("a",lt,y(e(i)("pages.login.forgotPassword")),1)]),c(He,{"login-param":e(s),onSubmit:H},null,8,["login-param"]),c(ae,{"mt-5":"",block:"",href:"/register"},{default:_(()=>[G(" 没有账号？去注册 ")]),_:1})]),_:1},8,["model"]),c(S,null,{default:_(()=>[r("span",pt,y(e(i)("pages.login.loginWith")),1)]),_:1}),r("div",ut,[c(e(Ee),{class:"icon",onClick:K}),c(e(Me),{disabled:"",class:"icon",onClick:Q}),c(e(Se),{disabled:"",class:"icon",onClick:J})])])])])])])}}}),V=he(_t,[["__scopeId","data-v-59a07a19"]]),mt=w({__name:"login-github",setup(n){const o=I(),a=E(),p=P();async function u(){const{data:l}=await O({type:"github",clientId:L.getGithubClientId(),code:b("code")});o.value=l==null?void 0:l.token,p.success({message:"登录成功",description:"欢迎回来！",duration:3});const s=b("redirect","/");a.push({path:s,replace:!0})}return T(()=>{u()}),(l,s)=>(m(),A("div"))}}),ht=w({__name:"login-alipay",setup(n){const o=I(),a=E(),p=P();async function u(){const{data:l}=await O({type:"alipay",code:b("auth_code")});o.value=l==null?void 0:l.token,p.success({message:"登录成功",description:"欢迎回来！",duration:3});const s=b("redirect","/");a.push({path:s,replace:!0})}return T(()=>{u()}),(l,s)=>(m(),A("div"))}}),gt=w({__name:"login-google",props:{hashParams:{type:Object,required:!0}},setup(n){const o=n,a=I(),p=E(),u=P();async function l(){const{data:s}=await O({type:"google",code:o.hashParams.access_token});a.value=s==null?void 0:s.token,u.success({message:"登录成功",description:"欢迎回来！",duration:3}),p.push({path:"/",replace:!0})}return T(()=>{l()}),(s,i)=>(m(),A("div"))}}),Lt=w({__name:"login",setup(n){const o=q(),a={sys:V,github:mt,alipay:ht,google:gt},p=N(l());let u=b("type");u||(u=p.value.state??""),o.value=a[u]??V;function l(){const i=ge.currentRoute.value.hash.substring(1).split("&"),g={};return i.forEach(k=>{const[C,M]=k.split("=");g[C]=M}),g}return(s,i)=>(m(),x(Le(e(o)),{"hash-params":e(p)},null,8,["hash-params"]))}});export{Lt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/aliYun-captcha-BfOA3s0e.js","assets/index-CDfL52KE.js","assets/vue-BVKynzoK.js","assets/antd-D-bStUmV.js","assets/index-TCS7UFXs.css","assets/geetest-DhOR7D1P.js","assets/original-CTwG1M04.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
