import{q as c,a as p,v as S}from"./index-CosWhGyj.js";import{d as _,s as g,a5 as w,a3 as y}from"./vue-BVKynzoK.js";var h=(e=>(e.alipay="alipay",e.wechat="wechat",e.paypal="paypal",e))(h||{});function D(e){return c("/payment/process",e,{customDev:!0})}function E(e){return c("/payment/payStatus",{tradeNo:e},{customDev:!0})}function $(e){return c("/payment/createOrder",e,{customDev:!0})}function I(e){return c("/sse/closeSse",e,{customDev:!0})}const C=_({__name:"index",emits:["receiveMsg"],setup(e,{expose:l,emit:f}){const m=f,s=g();async function v(t,r){var a,o;if(window.EventSource){const n=(a=p().userInfo)==null?void 0:a.id;s.value=new EventSource(`${(o=S.value)==null?void 0:o.baseURL}/sse/create/chargeEvent?tradeNo=${t}&userId=${n}&businessCode=${r}`),s.value.onmessage=function(i){i.data&&m("receiveMsg",i.data)},s.value.onerror=i=>{}}}async function d(t,r){var u,n;const a=p();(u=s.value)==null||u.close();const o={businessCode:t,businessId:r,userId:(n=a.userInfo)==null?void 0:n.id};await I(o)}return l({createSse:v,closeSse:d}),(t,r)=>(w(),y("div"))}});export{h as P,C as _,$ as a,D as c,E as p};
