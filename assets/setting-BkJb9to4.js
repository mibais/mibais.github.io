import{u as fe,v as re,s as pe,a as de,c as me,e as ve,b as be,g as ge,h as ye}from"./index-B2qMg0vS.js";import{t as F}from"./third-part-fnhvkpeN.js";import{u as M,_ as Le,n as ke,a as he}from"./index-DfSpHaIU.js";import{J as we,I as Ae,H as Ce,ao as j,a1 as Y,V as z,a2 as J,a3 as Q,a9 as K,ap as Se,aq as $e,ar as ee,as as Ue,O as Z,at as Ie,au as Te,aa as W,av as xe,ab as X,F as ae,ah as Pe,aw as Re,ax as Ne,ay as Oe,az as He,aA as Be,aB as Ee,N as te,K as Ke,m as De,am as Ge,aC as Me,aD as ze,A as Ve,ag as Fe,aE as qe,M as Ye}from"./antd-DWod4DQe.js";import{d as D,f as b,o as V,a5 as c,ac as v,ad as a,k as e,G as l,af as I,u as t,ag as L,a8 as R,a3 as E,H as q,F as le,au as Je,r as Qe,c as ne}from"./vue-DIvP5FMT.js";import{l as Ze,s as We}from"./index-Tg-aum74.js";import{_ as Xe,a as je}from"./deleteUser.vue_vue_type_script_setup_true_lang-B3dEFNiw.js";import{g as ea}from"./tools-lFUf1Wg_.js";import"./multi-tab-_INJbjdL.js";const aa="绑定第三方账号就可以借助第三方账号登陆网站。",ta=D({__name:"account-setting",setup(G){const n=b();function f(s){s==="google"&&window.open(F.getGoogleLoginUrl()),s==="github"&&(window.location.href=F.getGoogleLoginUrl()),s==="alipay"&&(window.location.href=F.getAliLoginUrl())}async function r(s){await fe(s),M().success("解绑成功"),await d()}async function d(){const{data:s}=await re();n.value=s}return V(()=>{d()}),(s,u)=>{const k=j,$=Y,h=z,T=J,m=Q,o=K;return c(),v(o,{title:"账号绑定",bordered:!1},{default:a(()=>[e(k,{"ml-5":"","mb-3":""},{default:a(()=>[l(I(aa))]),_:1}),e(m,{"item-layout":"horizontal","data-source":t(n)},{renderItem:a(({item:i})=>[e(T,null,{actions:a(()=>[i.band?(c(),v(h,{key:0,type:"link",onClick:g=>r(i.type)},{default:a(()=>[l(" 解绑 ")]),_:2},1032,["onClick"])):(c(),v(h,{key:1,type:"link",onClick:g=>f(i.type)},{default:a(()=>[l(" 绑定 ")]),_:2},1032,["onClick"]))]),default:a(()=>[e($,{description:i.band?`已绑定 ${i.name}`:"尚未绑定"},{title:a(()=>[l(I(i.type),1)]),avatar:a(()=>[i.type==="google"?(c(),v(t(we),{key:0,style:{color:"#ff4000"},class:"account-setting-avatar"})):L("",!0),i.type==="alipay"?(c(),v(t(Ae),{key:1,style:{color:"#2eabff"},class:"account-setting-avatar"})):L("",!0),i.type==="github"?(c(),v(t(Ce),{key:2,style:{color:"#fff","background-color":"#2eabff"},class:"account-setting-avatar"})):L("",!0)]),_:2},1032,["description"])]),_:2},1024)]),_:1},8,["data-source"])]),_:1})}}}),la=Le(ta,[["__scopeId","data-v-0a7b4bcd"]]),na=[{label:"中国",value:"CN",isLeaf:!1},{label:"中国香港",value:"HK",isLeaf:!1},{label:"中国台湾",value:"TW",isLeaf:!1},{label:"中国澳门",value:"MO",isLeaf:!1},{label:"阿根廷",value:"AR",isLeaf:!1},{label:"奥地利",value:"AT",isLeaf:!1},{label:"澳大利亚",value:"AU",isLeaf:!1},{label:"孟加拉",value:"BD",isLeaf:!1},{label:"保加利亚",value:"BG",isLeaf:!1},{label:"巴林",value:"BH",isLeaf:!1},{label:"巴西",value:"BR",isLeaf:!1},{label:"不丹",value:"BT",isLeaf:!1},{label:"加拿大",value:"CA",isLeaf:!1},{label:"瑞士",value:"CH",isLeaf:!1},{label:"哥伦比亚",value:"CO",isLeaf:!1},{label:"德国",value:"DE",isLeaf:!1},{label:"丹麦",value:"DK",isLeaf:!1},{label:"埃及",value:"EG",isLeaf:!1},{label:"西班牙",value:"ES",isLeaf:!1},{label:"法国",value:"FR",isLeaf:!1},{label:"英国",value:"GB",isLeaf:!1},{label:"格陵兰",value:"GL",isLeaf:!1},{label:"希腊",value:"GR",isLeaf:!1},{label:"克罗地亚",value:"HR",isLeaf:!1},{label:"匈牙利",value:"HU",isLeaf:!1},{label:"印度尼西亚",value:"ID",isLeaf:!1},{label:"爱尔兰",value:"IE",isLeaf:!1},{label:"以色列",value:"IL",isLeaf:!1},{label:"印度",value:"IN",isLeaf:!1},{label:"伊拉克",value:"IQ",isLeaf:!1},{label:"伊朗",value:"IR",isLeaf:!1},{label:"冰岛",value:"IS",isLeaf:!1},{label:"意大利",value:"IT",isLeaf:!1},{label:"日本",value:"JP",isLeaf:!1},{label:"柬埔寨",value:"KH",isLeaf:!1},{label:"朝鲜",value:"KR",isLeaf:!1},{label:"老挝",value:"LA",isLeaf:!1},{label:"黎巴嫩",value:"LB",isLeaf:!1},{label:"立陶宛",value:"LT",isLeaf:!1},{label:"卢森堡",value:"LU",isLeaf:!1},{label:"缅甸",value:"MM",isLeaf:!1},{label:"蒙古",value:"MN",isLeaf:!1},{label:"墨西哥",value:"MX",isLeaf:!1},{label:"马来西亚",value:"MY",isLeaf:!1},{label:"荷兰",value:"NL",isLeaf:!1},{label:"挪威",value:"NO",isLeaf:!1},{label:"新西兰",value:"NZ",isLeaf:!1},{label:"菲律宾",value:"PH",isLeaf:!1},{label:"巴基斯坦",value:"PK",isLeaf:!1},{label:"波兰",value:"PL",isLeaf:!1},{label:"葡萄牙",value:"PT",isLeaf:!1},{label:"罗马尼亚",value:"RO",isLeaf:!1},{label:"俄罗斯",value:"RU",isLeaf:!1},{label:"瑞典",value:"SE",isLeaf:!1},{label:"新加坡",value:"SG",isLeaf:!1},{label:"叙利亚",value:"SY",isLeaf:!1},{label:"泰国",value:"TH",isLeaf:!1},{label:"土耳其",value:"TR",isLeaf:!1},{label:"乌克兰",value:"UA",isLeaf:!1},{label:"美国",value:"US",isLeaf:!1},{label:"乌拉圭",value:"UY",isLeaf:!1},{label:"梵蒂冈",value:"VA",isLeaf:!1},{label:"委内瑞拉",value:"VE",isLeaf:!1},{label:"越南",value:"VN",isLeaf:!1},{label:"也门",value:"YE",isLeaf:!1},{label:"南非",value:"ZA",isLeaf:!1}],sa=R("b",null,"失效",-1),oa=D({__name:"resetSubLink",setup(G){const n=b(),f=M(),r=b(!1),d=Se({scriptUrl:ke(()=>import("./iconfont-B_hmDsvv.js"),__vite__mapDeps([]))}),s=b({trustArea:[],enabledPeriod:!1,autoAreaTrust:!0,enabledProtect:!0,protectTimeRange:[]}),u=b(na);async function k(){const{data:m}=await pe();n.value=m.token,s.value=m}async function $(){const{data:m}=await de();M().success("重置成功"),n.value=m}async function h(m){const o=m[m.length-1];o.loading=!0;try{const{data:i}=await Ze(o.value);o.children=i,u.value=[...u.value]}finally{o.loading=!1}}async function T(){if(!r.value){r.value=!0,f.loading({content:"正在保存中...",key:"saveSubSafe",duration:0});try{await We(s.value),f.success({content:"保存成功",key:"saveSubSafe",duration:2})}finally{r.value=!1}}}return V(()=>{k()}),(m,o)=>{const i=Y,g=z,_=ee,p=J,y=Ue,w=Z,N=Ie,O=Te,x=W,H=xe,P=X,A=ae,C=Q,B=K;return c(),v(B,{title:"订阅设置"},{default:a(()=>[e(C,{"item-layout":"horizontal"},{default:a(()=>[e(p,null,{actions:a(()=>[e(g,{danger:"",type:"primary",onClick:$},{default:a(()=>[l(" 重置 ")]),_:1})]),default:a(()=>[e(i,{"mb-5":""},{avatar:a(()=>[e(t(d),{style:{fontSize:"2.6em"},type:"icon-dingyue"})]),title:a(()=>[l(" 重置订阅链接 ")]),description:a(()=>[l(" 这里会重置您的订阅链接并"),sa,l("之前的订阅，此操作不可逆请谨慎操作 ")]),_:1}),l(" 当前订阅链接："),e(_,{class:"accent"},{default:a(()=>[l(I(t(n)),1)]),_:1})]),_:1}),e(p,{"mt-5":""},{default:a(()=>[e(i,{"mb-5":""},{title:a(()=>[l(" 订阅保护 ")]),avatar:a(()=>[e(t($e),{style:{fontSize:"2.6em"}})]),description:a(()=>[l(" 订阅安全关闭之后会让你的订阅处于滥用的风险 ")]),_:1}),l(" # "),e(A,null,{default:a(()=>[e(w,{tooltip:"订阅保护的总开关",label:"订阅安全保护"},{default:a(()=>[e(y,{checked:t(s).enabledProtect,"onUpdate:checked":o[0]||(o[0]=S=>t(s).enabledProtect=S),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1}),e(w,{tooltip:"将登录网站时所在地区自动列为保护区域，建议开启",label:"自动区域保护"},{default:a(()=>[e(y,{checked:t(s).autoAreaTrust,"onUpdate:checked":o[1]||(o[1]=S=>t(s).autoAreaTrust=S),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1}),e(w,{label:"区域保护","help:":"选择授信地区以保护订阅安全",tooltip:"只有列在此处的地区才能进行订阅"},{default:a(()=>[e(N,{value:t(s).trustArea,"onUpdate:value":o[2]||(o[2]=S=>t(s).trustArea=S),"load-data":h,options:t(u),multiple:"","show-search":"",placeholder:"尚未选择授信地区"},null,8,["value","options"])]),_:1}),e(w,{label:"时间段保护",help:"置空则关闭时间段保护",tooltip:"只有在该时间段才允许订阅"},{default:a(()=>[e(O,{value:t(s).protectTimeRange,"onUpdate:value":o[3]||(o[3]=S=>t(s).protectTimeRange=S),"second-step":30,"minute-step":15,"value-format":"HHmmss",format:"HH:mm"},null,8,["value"])]),_:1}),e(P,null,{default:a(()=>[e(x,{span:6},{default:a(()=>[e(w,{tooltip:"是否开启订阅链接有效期",label:"有效期保护"},{default:a(()=>[e(y,{checked:t(s).enabledPeriod,"onUpdate:checked":o[4]||(o[4]=S=>t(s).enabledPeriod=S),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})]),_:1}),e(x,{span:12},{default:a(()=>[e(w,{tooltip:"订阅链接自获取之后的有效时间，海外ip订阅不受此影响",help:"暂不能手动指定该值",label:"有效期"},{default:a(()=>[e(H,{"addon-after":"秒",value:"60",disabled:""})]),_:1})]),_:1})]),_:1}),e(w,null,{default:a(()=>[e(g,{type:"primary",loading:t(r),onClick:T},{default:a(()=>[l(" 保存 ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),ua={key:0,"mt-5":""},ia=R("a",{href:"https://www.microsoft.com/en-us/account/authenticator/"},"微软验证器",-1),ca=R("a",{href:"https://support.1password.com/one-time-passwords/"},"1Password",-1),_a={key:1,"mt-5":""},fa={key:2,"mt-10":"","mb-10":""},ra={class:"steps-action"},pa=D({__name:"double-auth",setup(G){const n=b(0),f=b(""),r=b(!1),d=b({qrcodeUrl:"",secretKey:"",verify:!1,backup:!1,backupCode:"",enabled:!1}),s=M(),u=b(!1),k=b(!1);async function $(){const{data:_}=await be();d.value=_,_.verify?_.backup||(n.value=1):n.value=0}async function h(){const{data:_}=await ge();return _}async function T(){return f.value?(await ye(f.value),s.success("绑定成功！"),!0):(s.warning("请先输入验证码"),!1)}async function m(_){_===1&&await T()&&(n.value=1),_===2&&await h()&&(n.value=2)}async function o(){await me(),s.success("两步验证已关闭"),await g()}function i(_){if(!_){k.value=!1;return}r.value?k.value=!0:(u.value=!0,$())}async function g(){const{data:_}=await ve();r.value=_}return V(()=>{g()}),(_,p)=>{const y=z,w=Re,N=Y,O=J,x=Ne,H=Oe,P=He,A=j,C=Be,B=ee,S=Ee,se=te,oe=Z,ue=Ke,ie=De,ce=K,_e=Ge;return c(),E(le,null,[e(O,null,{extra:a(()=>[e(w,{title:"你确定要关闭两步验证吗？",open:t(k),onOpenChange:i,onConfirm:o},{default:a(()=>[e(y,{type:"default"},{default:a(()=>[l(I(t(r)?"关闭":"开启")+"两步验证 ",1)]),_:1})]),_:1},8,["open"])]),default:a(()=>[e(N,{description:`为你的账号更有保障力. 当前状态：${t(r)?"已开启":"未开启"}`},{title:a(()=>[l(" 两步验证 ")]),avatar:a(()=>[e(t(Pe),{style:{fontSize:"2.6em"}})]),_:1},8,["description"])]),_:1}),e(_e,{open:t(u),"onUpdate:open":p[4]||(p[4]=U=>q(u)?u.value=U:null),closable:!1,width:650,"mask-closable":!1,footer:null},{default:a(()=>[e(ce,{title:"启用两步验证(2FA)",bordered:!1},{default:a(()=>[e(H,{current:t(n)},{default:a(()=>[e(x,{title:"验证"},{description:a(()=>[l(" 下载软件并验证 ")]),_:1}),e(x,{title:"备份"},{description:a(()=>[l(" 保存备份密钥 ")]),_:1}),e(x,{title:"完成"},{description:a(()=>[l(" 恭喜你设置成功 ")]),_:1})]),_:1},8,["current"]),t(n)===0?(c(),E("div",ua,[e(P,{level:4},{default:a(()=>[l(" 1、下载验证器app ")]),_:1}),e(A,null,{default:a(()=>[l(" 市面上的验证器有："),ia,l(" 、"),ca,l("、谷歌验证器等，请根据自身情况选择适合的app下载。 ")]),_:1}),e(P,{level:4},{default:a(()=>[l(" 2、绑定验证码 ")]),_:1}),e(A,null,{default:a(()=>[l(" 使用下载的app，扫描下方二维码 ")]),_:1}),e(C,{size:200,value:t(d).qrcodeUrl},null,8,["value"]),e(S,{title:"手动验证"},{content:a(()=>[e(A,null,{default:a(()=>[l("请输入下方密钥填入app内")]),_:1}),e(B,{strong:"",copyable:""},{default:a(()=>[l(I(t(d).secretKey),1)]),_:1})]),default:a(()=>[e(y,{type:"link"},{default:a(()=>[l(" 无法扫码二维码？ ")]),_:1})]),_:1}),e(P,{level:4},{default:a(()=>[l(" 3、输入验证码 ")]),_:1}),e(A,null,{default:a(()=>[l(" 请输入你看到你的验证码 ")]),_:1}),e(oe,null,{default:a(()=>[e(se,{value:t(f),"onUpdate:value":p[0]||(p[0]=U=>q(f)?f.value=U:null)},null,8,["value"])]),_:1})])):L("",!0),t(n)===1?(c(),E("div",_a,[e(A,null,{default:a(()=>[l(" 请记住下方的这串备份密钥，它是在当你无法使用验证器app时的备用方案，请牢记该密钥。当你点击 "),e(B,null,{default:a(()=>[l("下一步")]),_:1}),l(" ， 即表示你已妥善处理好此事。备份密钥只显示一次。 ")]),_:1}),e(A,{mark:"",style:{textAlign:"center"}},{default:a(()=>[e(B,{strong:""},{default:a(()=>{var U;return[l(I((U=t(d))==null?void 0:U.backupCode),1)]}),_:1})]),_:1})])):L("",!0),t(n)===2?(c(),E("div",fa,[e(A,null,{default:a(()=>[e(ue,{type:"success","show-icon":"",message:"开启成功",description:"你已成功开启两步验证，后续登录都会要求提供两步验证以保证账号安全"})]),_:1})])):L("",!0),R("div",ra,[e(ie,{size:"middle"},{default:a(()=>[t(n)===0?(c(),v(y,{key:0,onClick:p[1]||(p[1]=U=>u.value=!1)},{default:a(()=>[l(" 取消 ")]),_:1})):L("",!0),t(n)<2?(c(),v(y,{key:1,type:"primary",onClick:p[2]||(p[2]=U=>m(t(n)+1))},{default:a(()=>[l(" 下一步 ")]),_:1})):L("",!0),t(n)===2?(c(),v(y,{key:2,type:"primary",onClick:p[3]||(p[3]=U=>{u.value=!1,g()})},{default:a(()=>[l(" 完成 ")]),_:1})):L("",!0)]),_:1})])]),_:1})]),_:1},8,["open"])],64)}}}),da={class:"flex flex-col items-center"},ma=D({__name:"basic-setting",setup(G){var h,T;const{t:n}=Je(),f=he(),r=b(),d={span:0},s={span:13},u=Qe({email:(h=f.userInfo)==null?void 0:h.email,name:(T=f.userInfo)==null?void 0:T.username}),k=ne(()=>({name:[{required:!0,message:n("account.settings.form-rule-name"),trigger:"change"}],email:[{required:!0,message:n("account.settings.form-email"),trigger:"change"}]}));function $(){r.value.validate().then(()=>{}).catch(m=>{})}return(m,o)=>{const i=te,g=Z,_=z,p=ae,y=W,w=ze,N=Ve,O=Fe,x=qe,H=X,P=K,A=Q;return c(),E(le,null,[e(P,{"mb-5":"",title:t(n)("account.settings.basic-setting"),bordered:!1},{default:a(()=>[e(H,null,{default:a(()=>[e(y,{span:12},{default:a(()=>[e(p,{ref_key:"formRef",ref:r,model:t(u),rules:t(k),"label-col":d,"wrapper-col":s},{default:a(()=>[e(g,{"label-col":{span:24},label:"邮箱"},{default:a(()=>{var C;return[e(i,{tootpip:"",disabled:"",value:(C=t(f).userInfo)==null?void 0:C.email,style:{width:"320px"}},null,8,["value"])]}),_:1}),e(g,{"label-col":{span:24},label:t(n)("account.settings.form-name"),name:"name"},{default:a(()=>[e(i,{value:t(u).name,"onUpdate:value":o[0]||(o[0]=C=>t(u).name=C),placeholder:t(n)("account.settings.form-input-plac"),style:{width:"320px"}},null,8,["value","placeholder"])]),_:1},8,["label"]),e(g,null,{default:a(()=>[e(_,{type:"primary",onClick:$},{default:a(()=>[l(I(t(n)("account.settings.form-submit")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1}),e(y,{span:4},{default:a(()=>[R("p",null,I(t(n)("account.settings.basic-avatar")),1),R("div",da,[e(N,{size:100},{icon:a(()=>{var C;return[e(w,{src:(C=t(f).userInfo)==null?void 0:C.avatar},null,8,["src"])]}),_:1}),e(x,{disabled:"",name:"file","file-list":[]},{default:a(()=>[e(O,{title:"暂不支持"},{default:a(()=>[e(_,{class:"mt-4"},{default:a(()=>[e(t(Me)),l(" "+I(t(n)("account.settings.basic-avatar.upload")),1)]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["title"]),e(P,{title:"安全设置","mb-20":"",bordered:!1},{default:a(()=>[e(A,{"item-layout":"horizontal"},{default:a(()=>[e(pa),e(Xe),e(je)]),_:1})]),_:1})],64)}}}),Ca=D({__name:"setting",setup(G){const n=b(["1"]),f=ne(()=>[{key:"1",label:"基本信息",title:"Navigation One"},{key:"2",label:"账号绑定",title:"Navigation Two"},{key:"4",label:"协议和混淆",disabled:!0,title:"Navigation Two"},{key:"5",label:"订阅保护",title:"Navigation Two"}]);return V(()=>{const r=ea("key");n.value=[r||"1"]}),(r,d)=>{const s=Ye,u=W,k=X,$=K;return c(),v($,null,{default:a(()=>[e(k,{gutter:24},{default:a(()=>[e(u,{span:4,style:{"padding-left":"0"}},{default:a(()=>[e(s,{selectedKeys:t(n),"onUpdate:selectedKeys":d[0]||(d[0]=h=>q(n)?n.value=h:null),style:{width:"250px"},mode:"inline",items:t(f)},null,8,["selectedKeys","items"])]),_:1}),e(u,{span:20},{default:a(()=>[t(n)[0]==="1"?(c(),v(ma,{key:0})):L("",!0),t(n)[0]==="2"?(c(),v(la,{key:1})):L("",!0),t(n)[0]==="5"?(c(),v(oa,{key:2})):L("",!0)]),_:1})]),_:1})]),_:1})}}});export{Ca as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
